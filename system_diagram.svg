<svg viewBox="0 0 800 1000" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="400" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Narrative Transformation Pipeline
  </text>
  
  <!-- Input Layer -->
  <rect x="50" y="60" width="700" height="100" fill="#e6f3ff" stroke="#3182ce" stroke-width="2" rx="5"/>
  <text x="400" y="85" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    INPUT LAYER
  </text>
  
  <rect x="80" y="100" width="280" height="50" fill="#bee3f8" stroke="#3182ce" stroke-width="1" rx="3"/>
  <text x="220" y="130" font-size="14" text-anchor="middle" fill="#2d3748">Source Material Database</text>
  
  <rect x="440" y="100" width="280" height="50" fill="#bee3f8" stroke="#3182ce" stroke-width="1" rx="3"/>
  <text x="580" y="130" font-size="14" text-anchor="middle" fill="#2d3748">Target World Database</text>
  
  <!-- Arrow down -->
  <path d="M 400 160 L 400 190" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 1: Extraction -->
  <rect x="50" y="200" width="700" height="100" fill="#fef5e7" stroke="#d69e2e" stroke-width="2" rx="5"/>
  <text x="400" y="225" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    STAGE 1: Narrative Core Extraction
  </text>
  <text x="400" y="245" font-size="12" text-anchor="middle" fill="#744210">
    Extract: protagonists, antagonists, conflict, themes, plot beats, emotional arc
  </text>
  <text x="400" y="265" font-size="12" text-anchor="middle" fill="#744210">
    Method: Rule-based from structured data
  </text>
  <rect x="680" y="210" width="60" height="25" fill="#f6ad55" stroke="#d69e2e" stroke-width="1" rx="3"/>
  <text x="710" y="228" font-size="11" text-anchor="middle" fill="#2d3748">Human</text>
  
  <!-- Arrow down -->
  <path d="M 400 300 L 400 330" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 2: World Building -->
  <rect x="50" y="340" width="700" height="100" fill="#fef5e7" stroke="#d69e2e" stroke-width="2" rx="5"/>
  <text x="400" y="365" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    STAGE 2: World Parameter Building
  </text>
  <text x="400" y="385" font-size="12" text-anchor="middle" fill="#744210">
    Define: setting, power structures, conflicts, tech level, cultural norms, stakes
  </text>
  <text x="400" y="405" font-size="12" text-anchor="middle" fill="#744210">
    Method: Structured parameter definition
  </text>
  <rect x="680" y="350" width="60" height="25" fill="#f6ad55" stroke="#d69e2e" stroke-width="1" rx="3"/>
  <text x="710" y="368" font-size="11" text-anchor="middle" fill="#2d3748">Human</text>
  
  <!-- Arrow down -->
  <path d="M 400 440 L 400 470" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 3: Character Mapping -->
  <rect x="50" y="480" width="700" height="100" fill="#e6fffa" stroke="#38b2ac" stroke-width="2" rx="5"/>
  <text x="400" y="505" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    STAGE 3: Character Mapping
  </text>
  <text x="400" y="525" font-size="12" text-anchor="middle" fill="#234e52">
    Map: roles, traits, motivations, relationships to new context
  </text>
  <text x="400" y="545" font-size="12" text-anchor="middle" fill="#234e52">
    Method: AI generation with JSON output constraints
  </text>
  <rect x="680" y="490" width="60" height="25" fill="#81e6d9" stroke="#38b2ac" stroke-width="1" rx="3"/>
  <text x="710" y="508" font-size="11" text-anchor="middle" fill="#2d3748">AI</text>
  
  <!-- Arrow down -->
  <path d="M 400 580 L 400 610" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 4: Plot Transformation -->
  <rect x="50" y="620" width="700" height="100" fill="#e6fffa" stroke="#38b2ac" stroke-width="2" rx="5"/>
  <text x="400" y="645" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    STAGE 4: Plot Transformation
  </text>
  <text x="400" y="665" font-size="12" text-anchor="middle" fill="#234e52">
    Transform: plot beats, emotional pacing, thematic resonance, causal logic
  </text>
  <text x="400" y="685" font-size="12" text-anchor="middle" fill="#234e52">
    Method: AI generation guided by world constraints
  </text>
  <rect x="680" y="630" width="60" height="25" fill="#81e6d9" stroke="#38b2ac" stroke-width="1" rx="3"/>
  <text x="710" y="648" font-size="11" text-anchor="middle" fill="#2d3748">AI</text>
  
  <!-- Arrow down -->
  <path d="M 400 720 L 400 750" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 5: Narrative Generation -->
  <rect x="50" y="760" width="700" height="100" fill="#e6fffa" stroke="#38b2ac" stroke-width="2" rx="5"/>
  <text x="400" y="785" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    STAGE 5: Narrative Generation
  </text>
  <text x="400" y="805" font-size="12" text-anchor="middle" fill="#234e52">
    Generate: coherent prose synthesizing all transformation data
  </text>
  <text x="400" y="825" font-size="12" text-anchor="middle" fill="#234e52">
    Method: Comprehensive AI generation with full context
  </text>
  <rect x="680" y="770" width="60" height="25" fill="#81e6d9" stroke="#38b2ac" stroke-width="1" rx="3"/>
  <text x="710" y="788" font-size="11" text-anchor="middle" fill="#2d3748">AI</text>
  
  <!-- Arrow down -->
  <path d="M 400 860 L 400 890" stroke="#2d3748" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Output Layer -->
  <rect x="50" y="900" width="700" height="80" fill="#fce8f3" stroke="#d53f8c" stroke-width="2" rx="5"/>
  <text x="400" y="925" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    OUTPUT LAYER
  </text>
  
  <rect x="80" y="940" width="200" height="30" fill="#fbb6ce" stroke="#d53f8c" stroke-width="1" rx="3"/>
  <text x="180" y="960" font-size="12" text-anchor="middle" fill="#2d3748">Final Narrative</text>
  
  <rect x="300" y="940" width="200" height="30" fill="#fbb6ce" stroke="#d53f8c" stroke-width="1" rx="3"/>
  <text x="400" y="960" font-size="12" text-anchor="middle" fill="#2d3748">Metadata</text>
  
  <rect x="520" y="940" width="200" height="30" fill="#fbb6ce" stroke="#d53f8c" stroke-width="1" rx="3"/>
  <text x="620" y="960" font-size="12" text-anchor="middle" fill="#2d3748">Intermediate Data</text>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2d3748"/>
    </marker>
  </defs>
  
  <!-- Legend -->
  <g transform="translate(50, 50)">
    <rect x="550" y="-20" width="140" height="60" fill="white" stroke="#cbd5e0" stroke-width="1" rx="3"/>
    <text x="620" y="-5" font-size="12" font-weight="bold" text-anchor="middle" fill="#2d3748">Legend</text>
    <rect x="560" y="5" width="30" height="15" fill="#f6ad55" stroke="#d69e2e" stroke-width="1" rx="2"/>
    <text x="595" y="16" font-size="10" text-anchor="start" fill="#2d3748">Human-curated</text>
    <rect x="560" y="25" width="30" height="15" fill="#81e6d9" stroke="#38b2ac" stroke-width="1" rx="2"/>
    <text x="595" y="36" font-size="10" text-anchor="start" fill="#2d3748">AI-powered</text>
  </g>
</svg>